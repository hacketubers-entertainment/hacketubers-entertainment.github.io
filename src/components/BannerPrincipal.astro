---
import ScreenRelative from "./ScreenRelative.astro";
---

<script is:inline>
  function verMas() {
    window.location.href = "#yo";
  }
  function verPortafolio() {
    window.location.href = "/GarlyPortfolio";
  }
</script>
<ScreenRelative />
<div class="contenedor-imagen-principal">
  <div class="contenido-informacion">
    <img
      class="logotipoHE"
      src="/logo.png"
      alt="Logotipo de Hacketubers Entertainment"
    />
    <p>Desarrollador de Aplicaciones y Videojuegos Indie</p>
    <div>
      <button onclick="verPortafolio()" class="ver-portfolio"
        >Portafolio Personal</button
      >
      <button onclick="verMas()" class="ver-mas">Ver Informaci√≥n</button>
    </div>
  </div>
  <style>
    .contenedor-imagen-principal {
      overflow: hidden;
      width: 100%;
      height: 80vh; /* Increased height for better impact */
      background-image: url("/fondoCuadros.webp");
      background-repeat: no-repeat;
      background-size: cover; /* Ensure it covers the area */
      background-position: center;
      background-attachment: fixed;
      box-shadow: inset 0 0 100px rgba(0, 0, 0, 0.5); /* Softer shadow */
      position: relative;
      display: flex;
      align-items: center; /* Center content vertically */
      padding-top: var(
        --navbar-height
      ); /* Ensure content is not covered by navbar */
    }

    .contenido-informacion {
      position: relative; /* Changed from absolute to relative for flex centering */
      margin-left: 5vw; /* Use margin instead of left */
      color: var(--color-text-light);
      background-color: rgba(0, 0, 0, 0.4); /* Darker glass */
      backdrop-filter: blur(15px);
      border-radius: var(--border-radius-lg);
      padding: var(--spacing-xl);
      max-width: 500px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    }

    .logotipoHE {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      opacity: 0;
      margin-bottom: var(--spacing-md);
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    }

    .contenido-informacion p {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: var(--spacing-lg);
      line-height: 1.4;
    }

    .ver-mas,
    .ver-portfolio {
      padding: 12px 24px;
      cursor: pointer;
      font-family: var(--font-main);
      font-weight: 600;
      border-radius: var(--border-radius-sm);
      transition: all 0.3s ease;
      font-size: 1rem;
      border: none;
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .ver-mas {
      background-color: transparent;
      color: white;
      border: 2px solid white;
    }

    .ver-mas:hover {
      background-color: white;
      color: var(--color-primary);
    }

    .ver-portfolio {
      background: var(--gradient-text);
      color: white;
      box-shadow: 0 4px 15px rgba(128, 0, 207, 0.4);
    }

    .ver-portfolio:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(128, 0, 207, 0.6);
    }

    @media screen and (max-width: 800px) {
      .contenedor-imagen-principal {
        justify-content: center;
        align-items: center;
      }
      .contenido-informacion {
        margin: 0 20px;
        text-align: center;
      }
    }
  </style>

  <script>
    import gsap from "gsap";

    // Wait for everything to load to ensure correct positions
    window.addEventListener("load", () => {
      gsap.to(".contenedorRelativo", {
        opacity: 1,
        duration: 0.5,
        onComplete: FadeOut,
      });
    });

    function FadeOut() {
      gsap.to(".contenedorRelativo", {
        opacity: 0,
        duration: 2,
        ease: "power1.in",
        onStart: animateLogo,
        onComplete: eliminarScreen,
      });
      // Removed the separate opacity animation for .logo as it's handled in animateLogo or redundant
    }

    function animateLogo() {
      const contenedor = document.querySelector(".contenedorRelativo");
      const logo = document.querySelector(".logo");
      const target = document.querySelector(".logotipoHE");

      if (!logo || !target) return;

      const fromRect = logo.getBoundingClientRect();
      const toRect = target.getBoundingClientRect();

      // Calculate centers
      const fromCenter = {
        x: fromRect.left + fromRect.width / 2,
        y: fromRect.top + fromRect.height / 2,
      };

      const toCenter = {
        x: toRect.left + toRect.width / 2,
        y: toRect.top + toRect.height / 2,
      };

      const dx = toCenter.x - fromCenter.x;
      const dy = toCenter.y - fromCenter.y;
      const sx = toRect.width / fromRect.width;
      const sy = toRect.height / fromRect.height;

      // Do NOT reset transform here, as it messes up the calculation relative to the centered position
      // gsap.set(logo, { x: 0, y: 0, scaleX: 1, scaleY: 1 });

      gsap.to(logo, {
        opacity: 1,
        duration: 1,
        x: "+=" + dx, // Move relative to current position
        y: "+=" + dy,
        scaleX: sx,
        scaleY: sy,
        ease: "power2.inOut",
        onComplete: animateHE,
      });
    }

    function animateHE() {
      const target = document.querySelector(".logotipoHE");
      if (target) {
        gsap.to(target, {
          opacity: 1,
        });
      }
    }

    function eliminarScreen() {
      const contenedor = document.querySelector(".contenedorRelativo");
      const logo = document.querySelector(".logo");
      contenedor?.remove();
      logo?.remove();
    }
  </script>
</div>
