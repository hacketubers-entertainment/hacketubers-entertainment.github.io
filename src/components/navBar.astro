---
const pathname = Astro.url.pathname;
---

<header>
  <div class="item">
    <h1>Hacketubers Entertainment</h1>
  </div>
  <div class="item"></div>
  <div class="SeccionesNavbar item">
    {
      pathname != "/" ? (
        <a class="apartados" href="/">
          <p>Home</p>
        </a>
      ) : (
        <div />
      )
    }
    <a class="apartados" href="/juegos"><p>Juegos</p></a>
    <a class="apartados" href="/apps"><p>Aplicaciones</p></a>
    <a class="apartados" href="/webs"><p>Sitios Web</p></a>
    <a class="apartados"><p>proyectos</p></a>
  </div>
  <label id="menu-button" class="btn_menu" class="apartados" for="btn-menu"
    ><img src="/icons/menu-01-stroke-rounded.svg" alt="Abrir menú" /></label
  >
</header>

<script is:inline>
  // Script para manejar la apertura del menú lateral
  const menuButton = document.getElementById("menu-button");
  if (menuButton) {
    menuButton.addEventListener("click", () => {
      if (typeof openNav === "function") {
        openNav();
      } else {
        console.error(
          "La función openNav no está definida. Asegúrate de que SideMenu.astro se carga y define openNav globalmente o ajusta la lógica de eventos.",
        );
      }
    });
  }

  // Animation Logic
  document.addEventListener("DOMContentLoaded", () => {
    const header = document.querySelector("header");
    const isHome = window.location.pathname === "/";

    if (isHome && !sessionStorage.getItem("navbarAnimated")) {
      header.classList.add("animate-navbar");
      sessionStorage.setItem("navbarAnimated", "true");
      // Ensure it stays visible after animation
      header.addEventListener("animationend", () => {
        header.classList.add("visible");
        header.classList.remove("animate-navbar");
      });
    } else {
      header.classList.add("visible");
    }
  });
</script>

<style>
  :root {
    --tiempocomponente: 1s; /* Reduced time for snappier feel */
  }

  header {
    align-self: center;
    display: flex;
    flex-direction: row;
    justify-content: space-between; /* Better spacing */
    align-items: center;
    z-index: 100; /* Increased z-index to be above everything */
    width: 100vw;
    max-width: 100%;
    height: 80px;
    min-height: 80px;
    position: fixed;
    left: 0;
    top: 0;
    background-color: rgba(255, 255, 255, 0.9); /* Slight transparency */
    backdrop-filter: blur(10px); /* Glassmorphism */
    box-shadow: var(--shadow-sm);
    /* Animation removed from default */
    opacity: 0; /* Start hidden to avoid flash if animating, script will handle visibility */
    transform: translateY(-100%); /* Start hidden */
    transition: all 0.3s ease;
    padding: 0 20px; /* Add padding */
    box-sizing: border-box;
  }

  header.visible {
    opacity: 1;
    transform: translateY(0);
  }

  header.animate-navbar {
    animation: navbarAparece 0.8s ease-out forwards;
  }

  h1 {
    font-family: var(--font-display);
    font-size: 2rem;
    background: var(--gradient-text);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin: 0;
    cursor: pointer;
  }

  .SeccionesNavbar {
    display: flex;
    align-items: center;
    gap: 20px;
  }

  .apartados {
    font-family: var(--font-main);
    color: var(--color-text);
    text-decoration: none;
    font-weight: 600;
    padding: 8px 16px;
    border-radius: var(--border-radius-sm);
    transition: all 0.3s ease;
    display: flex; /* Ensure text is centered */
    align-items: center;
  }

  .apartados p {
    margin: 0;
  }

  .apartados:hover {
    background-color: rgba(128, 0, 207, 0.1); /* Light accent color */
    color: var(--color-accent);
    transform: translateY(-2px);
  }

  .btn_menu {
    cursor: pointer;
    display: none; /* Hidden by default on desktop */
    transition: transform 0.3s ease;
  }

  .btn_menu:hover {
    transform: scale(1.1);
  }

  @keyframes navbarAparece {
    from {
      transform: translateY(-100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @media only screen and (max-width: 853px) {
    header {
      justify-content: space-between;
    }

    .SeccionesNavbar {
      display: none; /* Hide links on mobile */
    }

    .btn_menu {
      display: block; /* Show menu button on mobile */
    }

    h1 {
      font-size: 1.5rem;
    }
  }
</style>
